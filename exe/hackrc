#!/bin/env rc

test -r $home/lib/profile && . $home/lib/profile

linefile = `{mktemp}
oldifs = $ifs
ifs = ()
nlc = `{echo}

fn prompt {
	echo -n '% '
}

fn unfin_prompt {
	echo -n '	'
}

fn sigint {
}

fn readline {
	ifs = ()
	hackline >[3] $linefile
	linedata = `{cat $"linefile}
	ifs = $oldfs
}

fn readevalline {
	prompt
	readline
	line = $"linedata
	while(! rc_is_line_finished $"line){
		echo
		unfin_prompt
		readline
		line = $"line^$"nlc^$"linedata
	}
}

while(true){
	readevalline
	echo
	eval $"line
}

